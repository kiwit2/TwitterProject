<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8">
		<link rel="stylesheet" type="text/css" href="css/main.css">
		<link rel="stylesheet" type="text/css" href="./node_modules/bootstrap/dist/css/bootstrap.min.css">
		<script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyAydAiR-XMBxYvsZznPr-_Q0GzrluXUSXU&libraries=places" type="text/javascript"></script>
		<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
		<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
		<title>Projector Display</title>
		<style type="text/css">
			#map {
				width: 100%;
				height: 100%;
				text-align: center;
		    }
        </style>
    </head>
    <body>
		<!--Title image -->
		<center><img src="images/epic.jpeg" height="150px" width="200px"></center>
  
		<div class="container" id="page-container">
        				  
			<div class="container" id="contents">
				<!----------------------------------------------TOP ROW----------------------------------------------------------------------->
				<div class='row'>
				    <!--Top left quad-->
					<div class="col-md-4" id="pics">
						<button id="fullscreenMode">Fullscreen</button><br>
						<div style="max-width:500px">
							<!--Add slideshow images here-->
							<div class="mySlides">
								<img id="pic" src="images/epic.jpeg">
							</div>
					
							<div class="mySlides">
								<img id="pic" src="images/firstframe.png">
							</div>
					
							<div class="mySlides">
								<img id="pic" src="images/secondframe.png">
							</div>
					
							<div class="mySlides">
								<img id="pic" src="images/thirdframe.png">
							</div>
					
							<div class="mySlides">
								<img id="pic" src="images/fourthframe.png">
							</div>
						</div>
					</div>
					<!--Top right quad-->
					<div class="col-md-8" id="mapcol">
						<div id="map">
						</div>
					</div>
				</div>
				<!---------------------------------------------------SECOND ROW----------------------------------------------------------> 
				<div class='row' style="padding-top:20px">
				    <!--Bottom left quad-->
					<div class="col-md-6" id="facebook">
						<iframe src="https://www.facebook.com/plugins/page.php?href=https%3A%2F%2Fwww.facebook.com%2FEPIC.Innovation.Campus%2F%3Ffref%3Dts&tabs=timeline&width=450px&height=800px&small_header=true&adapt_container_width=false&hide_cover=true&show_facepile=false&appId"
						width="450px" height="800px" style="border:none;overflow:hidden" scrolling="no" frameborder="0" allowTransparency="true"></iframe>
					</div>
					<!--Bottom right quad-->
					<div class="col-md-6" id="tweetcol">
						<center><h2>EPIC on <img src="images/twitterheader.png" height="24px" width="200px"></h2></center>
						<ul id="tweets">
						</ul>
					</div>
				</div>
			</div>
		</div>
    
	
		<script>	
			var markers = [];
			var count = 0;
			var icons = ["birds/Twitter_bird_logo1.png","birds/Twitter_bird_logo5.png","birds/Twitter_bird_logo2.png","birds/Twitter_bird_logo6.png","birds/Twitter_bird_logo3.png",
						"birds/Twitter_bird_logo7.png","birds/Twitter_bird_logo4.png","birds/Twitter_bird_logo8.png","birds/Twitter_bird_logo9.png","birds/Twitter_bird_logo10.png"]
	
			function initMap() {
				var haightAshbury = {lat: 0, lng: 0};
				var styledMapType = new google.maps.StyledMapType(
					[
						{
							"stylers": [
								{
									"hue": "#ff1a00"
								},
								{
									"invert_lightness": true
								},
								{
									"saturation": -100
								},
								{
									"lightness": 33
								},
								{
									"gamma": 0.5
								}
							]
						},
						{
							"featureType": "water",
							"elementType": "geometry",
							"stylers": [
								{
									"color": "#2D333C"
								}
							]
						}
					],
				{name: 'Styled Map'});
		  
				map = new google.maps.Map(document.getElementById('map'), {
					zoom: 1,
					center: haightAshbury,
					mapTypeControlOptions: {
					mapTypeIds: [
						'roadmap', 'satellite', 'styled_map']
					}
				});
		
				map.mapTypes.set('styled_map', styledMapType);
				map.setMapTypeId('styled_map');
			}
	  
			function addMarker(location) {
				var marker = new google.maps.Marker({
					position: location,
					map: map,
					icon: icons[count%10]
				});
		
				markers.push(marker);
				if (markers.length > 10) {
					markers[0].setMap(null);
					var out = markers.shift();
				}
				count += 1;
			}
      
	  
			function addTweet(tweet) {
				var newItem = document.createElement("LI");
				var textnode = document.createTextNode(tweet);
				$(newItem).append('<li><img src="' + icons[count%10] + '"/></li>');
				newItem.appendChild(textnode);
				var list = document.getElementById("tweets");
				list.insertBefore(newItem, list.childNodes[0]);
			}
			
			function getTweets() {
				$.ajax({
					url: 'http://localhost:8081/tweets',
					type:'GET',
					mimeType: 'application/json',
					datatype: 'json',
					async:true,
					crossDomain:true,
					cache: false,
					success: function (json) {
						console.log(json);
						console.log("Number of tweets recieved: " + json.tweets.length);
						
						for (var i = 0; i < json.tweets.length; i++) {
							json_location = json.tweets[i];
							json_tweet = json.tweet[i];
							json_user = json.user[i];
							latlon = new google.maps.LatLng(json_location[1], json_location[0]);
							addTweet(json_user + ":  " + json_tweet);
							addMarker(latlon);
							
							
						}
					},
					error: function () {
						alert("Twit bot not running on localhost.");
					}
				});
			}
			  
			function start_service() {
				window.setInterval(getTweets, 5000);
			}	  
			start_service();
	  
	  
	  
		</script>
		<script async defer
		src="https://maps.googleapis.com/maps/api/js?key=AIzaSyAydAiR-XMBxYvsZznPr-_Q0GzrluXUSXU&callback=initMap"></script>
		<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.10.1/jquery.min.js"></script>

        <!--jQuery Script-->
        <script src="./node_modules/jquery/dist/jquery.min.js"></script>
        <!--Bootstrap Script-->
        <script src="./node_modules/bootstrap/dist/js/bootstrap.min.js"></script>
        <!--Custom Script-->
        <script src="js/fullscreen.js"></script>
		<script src="js/slideshow.js"></script>
  </body>
</html>
